<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>–ò–Ω–≤–æ–π—Å-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ç–µ—Ö–Ω–∏–∫–∞ ‚Äî W&M</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        * { box-sizing: border-box; }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 0;
            padding: 20px;
            background: #e5e7eb;
            color: #111827;
            display: flex;
            justify-content: center;
        }

        .page {
            width: 100%;
            max-width: 1200px;
            background: #f9fafb;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(15, 23, 42, 0.25);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .logo-block {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 2px solid #0f766e;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 18px;
            color: #0f766e;
            background: #ecfdf5;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        .logo-sub {
            font-size: 12px;
            color: #6b7280;
        }

        .mode-switcher {
            display: flex;
            gap: 8px;
        }

        .mode-btn {
            border-radius: 999px;
            border: 1px solid #d1d5db;
            padding: 6px 14px;
            font-size: 13px;
            background: #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .mode-btn span {
            font-size: 18px;
        }

        .mode-btn.active {
            background: #0f766e;
            color: #ecfdf5;
            border-color: #0f766e;
        }

        .page-body {
            display: grid;
            grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
            gap: 20px;
        }

        @media (max-width: 960px) {
            .page-body {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: #ffffff;
            border-radius: 14px;
            padding: 16px 18px;
            border: 1px solid #e5e7eb;
        }

        .card-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title small {
            font-weight: 400;
            color: #6b7280;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 10px;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-bottom: 8px;
        }

        .field label {
            font-size: 12px;
            color: #4b5563;
        }

        .field input, .field select {
            border-radius: 10px;
            border: 1px solid #d1d5db;
            padding: 7px 9px;
            font-size: 13px;
            width: 100%;
            background: #f9fafb;
        }

        .field input:focus, .field select:focus {
            outline: none;
            border-color: #0f766e;
            box-shadow: 0 0 0 1px rgba(15, 118, 110, 0.25);
            background: #ffffff;
        }

        .field-row {
            display: grid;
            grid-template-columns: 1.5fr 0.9fr 0.9fr;
            gap: 8px;
            align-items: center;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 11px;
            background: #ecfdf5;
            color: #047857;
            border: 1px solid #bbf7d0;
        }

        .badge span {
            font-size: 14px;
        }

        .btn-main {
            margin-top: 10px;
            width: 100%;
            border-radius: 999px;
            border: none;
            background: #0f766e;
            color: #ecfdf5;
            padding: 9px 14px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-main:hover {
            background: #115e59;
        }

        .invoice-preview {
            background: #ffffff;
            border-radius: 14px;
            border: 1px solid #e5e7eb;
            padding: 18px 18px 22px;
        }

        .inv-header {
            display: flex;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 12px;
        }

        .inv-company {
            font-weight: 600;
        }

        .inv-sub {
            font-size: 12px;
            color: #6b7280;
        }

        .inv-meta {
            font-size: 12px;
            color: #4b5563;
            text-align: right;
        }

        .inv-meta div {
            line-height: 1.4;
        }

        .inv-billto {
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 10px 12px;
            font-size: 12px;
            margin-bottom: 12px;
        }

        .inv-billto strong {
            font-size: 12px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        th, td {
            padding: 6px 4px;
            border-bottom: 1px solid #e5e7eb;
            text-align: right;
        }

        th:first-child, td:first-child {
            text-align: left;
        }

        th:nth-child(2), td:nth-child(2) {
            text-align: center;
        }

        tfoot td {
            border-bottom: none;
        }

        .text-right { text-align: right; }
        .text-left { text-align: left; }

        .inv-summary {
            width: 260px;
            margin-left: auto;
            font-size: 12px;
            margin-top: 10px;
        }

        .inv-summary div {
            display: flex;
            justify-content: space-between;
            padding: 2px 0;
        }

        .inv-grand {
            font-weight: 700;
            border-top: 1px solid #e5e7eb;
            margin-top: 3px;
            padding-top: 4px;
        }

        .sign-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 26px;
            font-size: 11px;
            color: #6b7280;
        }

        .sign-line {
            border-top: 1px solid #d1d5db;
            margin-top: 28px;
        }

        .sign-label {
            margin-top: 4px;
        }

        .mode-hint {
            font-size: 11px;
            color: #6b7280;
            margin-left: 6px;
        }

        .easy-note {
            font-size: 12px;
            color: #374151;
            margin-bottom: 8px;
        }

    </style>
</head>
<body>
<div class="page">
    <div class="page-header">
        <div class="logo-block">
            <div class="logo-icon">W&amp;M</div>
            <div class="logo-text">
                <div class="logo-title">Wilson &amp; Meyer Appliance Repairs</div>
                <div class="logo-sub">Professional Appliance Service &amp; Repair</div>
            </div>
        </div>
        <div class="mode-switcher">
            <button type="button" class="mode-btn active" id="btnModeFull">
                <span>üìÑ</span> FULL
            </button>
            <button type="button" class="mode-btn" id="btnModeEasy">
                <span>‚ö°</span> EASY
            </button>
        </div>
    </div>

    <div class="page-body">
        <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: —Ñ–æ—Ä–º—ã -->
        <div class="card">
            <!-- FULL MODE FORM -->
            <div id="fullForm">
                <div class="card-title">
                    –ò–Ω–≤–æ–π—Å (FULL)
                    <small>–ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –≤—Å—ë ‚Äî –¥–∞–Ω–Ω—ã–µ, –¥–µ—Ç–∞–ª–∏ –∏ –∏—Ç–æ–≥–∏.</small>
                </div>

                <div class="grid-2">
                    <div class="field">
                        <label>–ö–æ–º–ø–∞–Ω–∏—è</label>
                        <input id="companyName" type="text" value="Wilson and Meyer appliance repairs" />
                    </div>
                    <div class="field">
                        <label>–ù–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞</label>
                        <input id="invoiceNumber" type="text" value="6551" />
                    </div>
                </div>

                <div class="grid-2">
                    <div class="field">
                        <label>–î–∞—Ç–∞</label>
                        <input id="invoiceDate" type="date" />
                    </div>
                    <div class="field">
                        <label>–¢–µ—Ö–Ω–∏–∫ (–∏–º—è)</label>
                        <input id="technicianName" type="text" value="Technician" />
                    </div>
                </div>

                <div class="grid-2">
                    <div class="field">
                        <label>–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞</label>
                        <input id="clientName" type="text" />
                    </div>
                    <div class="field">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞</label>
                        <input id="clientPhone" type="text" />
                    </div>
                </div>

                <div class="field">
                    <label>–ê–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞</label>
                    <input id="clientAddress" type="text" />
                </div>

                <div class="field">
                    <label>–ñ–µ–ª–∞–µ–º–∞—è —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å ($)</label>
                    <input id="desiredProfit" type="number" inputmode="decimal" min="0" value="200" />
                </div>

                <div class="card-title" style="margin-top:12px;">
                    –î–µ—Ç–∞–ª–∏ (Parts)
                    <small>–ó–∞–ø–æ–ª–Ω–∏ —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ –æ–ø–ª–∞—á–∏–≤–∞–µ–º—É—é —Ü–µ–Ω—É –¥–µ—Ç–∞–ª–µ–π</small>
                </div>

                <!-- –ü—è—Ç—å —Å—Ç—Ä–æ–∫ –¥–µ—Ç–∞–ª–µ–π -->
                <div id="partsFull">
                    <div class="field">
                        <div class="field-row">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ 1</label>
                                <input id="p1Name" type="text" value="Part 1" />
                            </div>
                            <div>
                                <label>–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ 1 ($)</label>
                                <input id="p1Real" type="number" inputmode="decimal" min="0" step="0.01" />
                            </div>
                            <div>
                                <label>Qty</label>
                                <input id="p1Qty" type="number" value="1" min="0" />
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <div class="field-row">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ 2</label>
                                <input id="p2Name" type="text" value="Part 2" />
                            </div>
                            <div>
                                <label>–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ 2 ($)</label>
                                <input id="p2Real" type="number" inputmode="decimal" min="0" step="0.01" />
                            </div>
                            <div>
                                <label>Qty</label>
                                <input id="p2Qty" type="number" value="1" min="0" />
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <div class="field-row">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ 3</label>
                                <input id="p3Name" type="text" value="Part 3" />
                            </div>
                            <div>
                                <label>–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ 3 ($)</label>
                                <input id="p3Real" type="number" inputmode="decimal" min="0" step="0.01" />
                            </div>
                            <div>
                                <label>Qty</label>
                                <input id="p3Qty" type="number" value="1" min="0" />
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <div class="field-row">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ 4</label>
                                <input id="p4Name" type="text" value="Part 4" />
                            </div>
                            <div>
                                <label>–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ 4 ($)</label>
                                <input id="p4Real" type="number" inputmode="decimal" min="0" step="0.01" />
                            </div>
                            <div>
                                <label>Qty</label>
                                <input id="p4Qty" type="number" value="1" min="0" />
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <div class="field-row">
                            <div>
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ 5</label>
                                <input id="p5Name" type="text" value="Part 5" />
                            </div>
                            <div>
                                <label>–†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ 5 ($)</label>
                                <input id="p5Real" type="number" inputmode="decimal" min="0" step="0.01" />
                            </div>
                            <div>
                                <label>Qty</label>
                                <input id="p5Qty" type="number" value="1" min="0" />
                            </div>
                        </div>
                    </div>
                </div>

                <div class="field" style="margin-top:6px;">
                    <label>–°—Ç–∞–≤–∫–∞ –Ω–∞–ª–æ–≥–∞ –Ω–∞ –¥–µ—Ç–∞–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7.96%)</label>
                    <input id="taxRate" type="number" inputmode="decimal" value="7.96" />
                </div>

                <button class="btn-main" id="btnGenerateFull">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–≤–æ–π—Å (FULL)</button>
            </div>

            <!-- EASY MODE FORM -->
            <div id="easyForm" style="display:none;">
                <div class="card-title">
                    –ë—ã—Å—Ç—Ä—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (EASY)
                </div>
                <p class="easy-note">
                    –û—Ç–≤–µ—á–∞–µ—à—å —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–≤–∞ –≤–æ–ø—Ä–æ—Å–∞: <br />
                    1) –°–∫–æ–ª—å–∫–æ —Ö–æ—á–µ—à—å <b>—á–∏—Å—Ç—ã–º–∏</b>?<br />
                    2) –°–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ —Å—Ç–æ—è—Ç –¥–µ—Ç–∞–ª–∏ (–¥–æ 5 —à—Ç—É–∫)?<br />
                    –î–∞–ª—å—à–µ —è —Å—á–∏—Ç–∞—é –≤—Å—ë –ø–æ —Ñ–æ—Ä–º—É–ª–µ, —Ä–∞–∑–±–∏–≤–∞—é –Ω–∞ Parts / Tax / Labor.
                </p>

                <div class="field">
                    <label>–ñ–µ–ª–∞–µ–º–∞—è —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å ($)</label>
                    <input id="easyProfit" type="number" inputmode="decimal" min="0" value="200" />
                </div>

                <div class="card-title" style="margin-top:10px;">
                    –†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –¥–µ—Ç–∞–ª–µ–π
                    <span class="mode-hint">(–º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å 1‚Äì5 —à—Ç—É–∫)</span>
                </div>

                <div class="grid-2">
                    <div class="field">
                        <label>–î–µ—Ç–∞–ª—å 1 ($)</label>
                        <input id="e1Real" type="number" inputmode="decimal" min="0" step="0.01" />
                    </div>
                    <div class="field">
                        <label>–î–µ—Ç–∞–ª—å 2 ($)</label>
                        <input id="e2Real" type="number" inputmode="decimal" min="0" step="0.01" />
                    </div>
                </div>
                <div class="grid-2">
                    <div class="field">
                        <label>–î–µ—Ç–∞–ª—å 3 ($)</label>
                        <input id="e3Real" type="number" inputmode="decimal" min="0" step="0.01" />
                    </div>
                    <div class="field">
                        <label>–î–µ—Ç–∞–ª—å 4 ($)</label>
                        <input id="e4Real" type="number" inputmode="decimal" min="0" step="0.01" />
                    </div>
                </div>
                <div class="field">
                    <label>–î–µ—Ç–∞–ª—å 5 ($)</label>
                    <input id="e5Real" type="number" inputmode="decimal" min="0" step="0.01" />
                </div>

                <div class="field">
                    <label>–°—Ç–∞–≤–∫–∞ –Ω–∞–ª–æ–≥–∞ –Ω–∞ –¥–µ—Ç–∞–ª–∏ (%, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7.96)</label>
                    <input id="easyTaxRate" type="number" inputmode="decimal" value="7.96" />
                </div>

                <button class="btn-main" id="btnGenerateEasy">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–≤–æ–π—Å (EASY)</button>
            </div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ø—Ä–µ–≤—å—é –∏–Ω–≤–æ–π—Å–∞ -->
        <div class="invoice-preview" id="invoicePreview">
            <div class="inv-header">
                <div>
                    <div class="inv-company" id="outCompany">Wilson and Meyer appliance repairs</div>
                    <div class="inv-sub">Appliance Repair</div>
                </div>
                <div class="inv-meta">
                    <div>Invoice #: <span id="outInvoiceNumber">‚Äî</span></div>
                    <div>Date: <span id="outInvoiceDate">‚Äî</span></div>
                </div>
            </div>

            <div class="inv-billto" id="outBillTo">
                <strong>Bill To:</strong><br />
                <span id="outClientName">Client Name</span><br />
                <span id="outClientPhone"></span><br />
                <span id="outClientAddress"></span>
            </div>

            <table>
                <thead>
                <tr>
                    <th>Description</th>
                    <th>Qty</th>
                    <th>Unit</th>
                    <th>Tax</th>
                    <th>Total</th>
                </tr>
                </thead>
                <tbody id="invBody">
                <!-- —Å—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
                </tbody>
            </table>

            <div class="inv-summary">
                <div>
                    <span>Subtotal</span>
                    <span id="outSubtotal">$0.00</span>
                </div>
                <div>
                    <span>Tax (7.96% Parts)</span>
                    <span id="outTax">$0.00</span>
                </div>
                <div class="inv-grand">
                    <span>Grand Total</span>
                    <span id="outGrandTotal">$0.00</span>
                </div>
            </div>

            <div class="sign-row">
                <div>
                    <div class="sign-line"></div>
                    <div class="sign-label">Technician Signature</div>
                </div>
                <div>
                    <div class="sign-line"></div>
                    <div class="sign-label">Customer Signature</div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
(function () {
    const taxInput = document.getElementById("taxRate");
    const easyTaxInput = document.getElementById("easyTaxRate");

    // –∑–∞–ø–æ–ª–Ω—è–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
    const dateInput = document.getElementById("invoiceDate");
    const today = new Date();
    dateInput.value = today.toISOString().slice(0, 10);

    // –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ FULL / EASY
    const btnFull = document.getElementById("btnModeFull");
    const btnEasy = document.getElementById("btnModeEasy");
    const fullForm = document.getElementById("fullForm");
    const easyForm = document.getElementById("easyForm");

    btnFull.addEventListener("click", function () {
        btnFull.classList.add("active");
        btnEasy.classList.remove("active");
        fullForm.style.display = "block";
        easyForm.style.display = "none";
    });

    btnEasy.addEventListener("click", function () {
        btnEasy.classList.add("active");
        btnFull.classList.remove("active");
        fullForm.style.display = "none";
        easyForm.style.display = "block";
    });

    function toNumber(v) {
        const n = parseFloat(v);
        return isNaN(n) ? 0 : n;
    }

    function formatMoney(v) {
        return "$" + v.toFixed(2);
    }

    // –æ–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    function calculateInvoice(partsReal, desiredProfit, taxPercent) {
        const TAX_RATE = taxPercent / 100;
        const realPartsTotal = partsReal.reduce((s, v) => s + v, 0);

        // –§–æ—Ä–º—É–ª–∞ –∑–∞–∫–∞–∑—á–∏–∫–∞:
        // GrandTotalBase = —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å * 2 + —Å—É–º–º–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–µ—Ç–∞–ª–µ–π + 20
        let grandTotalBase = desiredProfit * 2 + realPartsTotal + 20;

        // –ß—Ç–æ–± –≤—ã–≥–ª—è–¥–µ–ª–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ, –¥–µ–ª–∞–µ–º –Ω–∞—Ü–µ–Ω–∫—É –Ω–∞ –¥–µ—Ç–∞–ª–∏,
        // –∞ –æ—Å—Ç–∞—Ç–æ–∫ —É—Ö–æ–¥–∏—Ç –≤ —Ä–∞–±–æ—Ç—É (Labor).
        let factor = 4.0;
        let partsSellTotal, partsTax, labor;

        function computeForFactor(f) {
            const p = realPartsTotal * f;
            const t = p * TAX_RATE;
            const l = grandTotalBase - (p + t);
            return { p, t, l };
        }

        let attempt = computeForFactor(factor);
        if (attempt.l < 50) {
            factor = 3.0;
            attempt = computeForFactor(factor);
        }
        if (attempt.l < 0) {
            factor = 2.0;
            attempt = computeForFactor(factor);
        }

        partsSellTotal = attempt.p;
        partsTax = attempt.t;
        labor = attempt.l;

        // –û–∫—Ä—É–≥–ª—è–µ–º —Ä–∞–±–æ—Ç—É –¥–æ —Ü–µ–ª–æ–≥–æ –¥–æ–ª–ª–∞—Ä–∞
        labor = Math.round(labor);

        // –ø–æ—Å–ª–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ–º grand total,
        // —á—Ç–æ–±—ã –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—Å—ë —Å—Ö–æ–¥–∏–ª–æ—Å—å
        const grandTotal = partsSellTotal + partsTax + labor;

        return {
            realPartsTotal,
            partsSellTotal,
            partsTax,
            labor,
            grandTotal,
            taxRate: TAX_RATE
        };
    }

    // –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ –∏–Ω–≤–æ–π—Å–∞
    function renderInvoice(partsNames, calc, clientData, invoiceMeta) {
        const tbody = document.getElementById("invBody");
        tbody.innerHTML = "";

        const singlePartPrice = partsNames.length > 0
            ? calc.partsSellTotal / partsNames.length
            : 0;

        partsNames.forEach(function (name) {
            const tr = document.createElement("tr");

            const tdDesc = document.createElement("td");
            tdDesc.textContent = name;

            const tdQty = document.createElement("td");
            tdQty.textContent = "1";

            const tdUnit = document.createElement("td");
            tdUnit.textContent = formatMoney(singlePartPrice);

            const tdTax = document.createElement("td");
            tdTax.textContent = formatMoney(singlePartPrice * calc.taxRate);

            const tdTotal = document.createElement("td");
            tdTotal.textContent = formatMoney(singlePartPrice * (1 + calc.taxRate));

            tr.appendChild(tdDesc);
            tr.appendChild(tdQty);
            tr.appendChild(tdUnit);
            tr.appendChild(tdTax);
            tr.appendChild(tdTotal);
            tbody.appendChild(tr);
        });

        // —Å—Ç—Ä–æ–∫–∞ Labor
        const trLabor = document.createElement("tr");
        const tdDescL = document.createElement("td");
        tdDescL.textContent = "Labor ‚Äì Work performed";

        const tdQtyL = document.createElement("td");
        tdQtyL.textContent = "1";

        const tdUnitL = document.createElement("td");
        tdUnitL.textContent = formatMoney(calc.labor);

        const tdTaxL = document.createElement("td");
        tdTaxL.textContent = "‚Äî";

        const tdTotalL = document.createElement("td");
        tdTotalL.textContent = formatMoney(calc.labor);

        trLabor.appendChild(tdDescL);
        trLabor.appendChild(tdQtyL);
        trLabor.appendChild(tdUnitL);
        trLabor.appendChild(tdTaxL);
        trLabor.appendChild(tdTotalL);
        tbody.appendChild(trLabor);

        // –æ–±–Ω–æ–≤–ª—è–µ–º —à–∞–ø–∫—É / –∏—Ç–æ–≥–∏
        document.getElementById("outCompany").textContent = invoiceMeta.company;
        document.getElementById("outInvoiceNumber").textContent = invoiceMeta.number || "‚Äî";
        document.getElementById("outInvoiceDate").textContent = invoiceMeta.date || "‚Äî";

        const billName = clientData.name || "Client Name";
        document.getElementById("outClientName").textContent = billName;
        document.getElementById("outClientPhone").textContent = clientData.phone || "";
        document.getElementById("outClientAddress").textContent = clientData.address || "";

        const subtotal = calc.partsSellTotal + calc.labor;
        document.getElementById("outSubtotal").textContent = formatMoney(subtotal);
        document.getElementById("outTax").textContent = formatMoney(calc.partsTax);
        document.getElementById("outGrandTotal").textContent = formatMoney(calc.grandTotal);
    }

    // FULL —Ä–µ–∂–∏–º
    document.getElementById("btnGenerateFull").addEventListener("click", function () {
        const desiredProfit = toNumber(document.getElementById("desiredProfit").value);
        const tRate = toNumber(taxInput.value || "7.96");

        const partReals = [];
        const partNames = [];

        for (let i = 1; i <= 5; i++) {
            const real = toNumber(document.getElementById("p" + i + "Real").value);
            const qty = toNumber(document.getElementById("p" + i + "Qty").value || "1");
            if (real > 0 && qty > 0) {
                for (let q = 0; q < qty; q++) {
                    partReals.push(real);
                    partNames.push(document.getElementById("p" + i + "Name").value || ("Part " + i));
                }
            }
        }

        const calc = calculateInvoice(partReals, desiredProfit, tRate);

        const invoiceMeta = {
            company: document.getElementById("companyName").value || "Wilson and Meyer appliance repairs",
            number: document.getElementById("invoiceNumber").value,
            date: document.getElementById("invoiceDate").value
        };

        const clientData = {
            name: document.getElementById("clientName").value,
            phone: document.getElementById("clientPhone").value,
            address: document.getElementById("clientAddress").value
        };

        renderInvoice(partNames, calc, clientData, invoiceMeta);
    });

    // EASY —Ä–µ–∂–∏–º
    document.getElementById("btnGenerateEasy").addEventListener("click", function () {
        const desiredProfit = toNumber(document.getElementById("easyProfit").value);
        const tRate = toNumber(easyTaxInput.value || "7.96");

        const partReals = [];
        const partNames = [];

        const easyIds = ["e1Real", "e2Real", "e3Real", "e4Real", "e5Real"];

        easyIds.forEach(function (id, idx) {
            const val = toNumber(document.getElementById(id).value);
            if (val > 0) {
                partReals.push(val);
                partNames.push("Part " + (idx + 1));
            }
        });

        const calc = calculateInvoice(partReals, desiredProfit, tRate);

        const invoiceMeta = {
            company: document.getElementById("companyName").value || "Wilson and Meyer appliance repairs",
            number: document.getElementById("invoiceNumber").value,
            date: document.getElementById("invoiceDate").value
        };

        const clientData = {
            name: document.getElementById("clientName").value,
            phone: document.getElementById("clientPhone").value,
            address: document.getElementById("clientAddress").value
        };

        renderInvoice(partNames, calc, clientData, invoiceMeta);
    });
})();
</script>
</body>
</html>
